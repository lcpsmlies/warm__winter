<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç«‹å†¬æš–å¿ƒæ¸¸æˆ - ç»™æ†¨è±†è±†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow: hidden;
            position: relative;
        }
        
        .container {
            max-width: 800px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
            padding: 40px 30px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            text-align: center;
            z-index: 10;
        }
        
        .header {
            margin-bottom: 30px;
        }
        
        h1 {
            color: #ff6b6b;
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .greeting {
            font-size: 1.5rem;
            color: #555;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #777;
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        
        .current-option {
            margin: 40px 0;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .blind-dumplings {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        
        .blind-dumpling {
            width: 100px;
            height: 100px;
            background: #ff9a3c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .blind-dumpling::before {
            content: "?";
            position: absolute;
            color: white;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .blind-dumpling:hover {
            transform: translateY(-10px) scale(1.1);
            background: #ff7b3c;
        }
        
        .blind-dumpling.opened {
            background: #ff6b6b;
            transform: scale(1.2);
            animation: bounce 0.5s ease;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1.2); }
            50% { transform: scale(1.4); }
        }
        
        .blessing-message {
            position: fixed;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9);
            z-index: 20;
            animation: floatRandom 8s linear forwards;
            pointer-events: none;
            white-space: nowrap;
        }
        
        @keyframes floatRandom {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(
                    calc((Math.random() - 0.5) * 300px - 150px), 
                    -100vh
                ) rotate(calc((Math.random() - 0.5) * 360deg));
                opacity: 0;
            }
        }
        
        .explosion {
            position: fixed;
            font-size: 4rem;
            animation: explode 1.5s ease-out forwards;
            z-index: 100;
            pointer-events: none;
        }
        
        @keyframes explode {
            0% { 
                transform: scale(0.5) rotate(0deg); 
                opacity: 1; 
            }
            50% { 
                transform: scale(2) rotate(180deg); 
                opacity: 0.8;
            }
            100% { 
                transform: scale(3) rotate(360deg); 
                opacity: 0; 
            }
        }
        
        .snowflake {
            position: fixed;
            color: #b3e0ff;
            font-size: 2rem;
            user-select: none;
            z-index: 5;
            animation: snowFall linear forwards;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
        }
        
        @keyframes snowFall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .warm-message {
            position: fixed;
            font-size: 2rem;
            color: #ff6b6b;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9);
            z-index: 15;
            animation: warmFloat 12s ease-in-out infinite;
            pointer-events: none;
            white-space: nowrap;
        }
        
        @keyframes warmFloat {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
                opacity: 0.8;
            }
            25% {
                transform: translate(40px, -50px) rotate(5deg) scale(1.1);
            }
            50% {
                transform: translate(-30px, -100px) rotate(-5deg) scale(0.9);
            }
            75% {
                transform: translate(20px, -150px) rotate(3deg) scale(1.05);
            }
        }
        
        .progress-bar {
            height: 10px;
            background: #f0f0f0;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #ff9a3c, #ff6b6b);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            color: #777;
            font-style: italic;
        }
        
        .heart {
            color: #ff6b6b;
            animation: heartbeat 1.5s infinite;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .final-message {
            font-size: 1.5rem;
            line-height: 1.8;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            display: none;
            position: relative;
        }
        
        .big-heart-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto 30px;
            display: none;
        }
        
        .small-heart {
            position: absolute;
            font-size: 2.5rem;
            color: #ff0000;
            animation: smallHeartbeat 2s infinite;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            z-index: 25;
        }
        
        @keyframes smallHeartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.3); }
            50% { transform: scale(1.1); }
            75% { transform: scale(1.2); }
        }
        
        .quiz-container {
            margin: 20px 0;
        }
        
        .quiz-question {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #555;
        }
        
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .quiz-option {
            padding: 15px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .quiz-option:hover {
            background: rgba(255, 154, 60, 0.2);
            border-color: #ff9a3c;
            transform: translateX(10px);
        }
        
        .selected-dumplings {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .selected-dumpling {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: popIn 0.5s ease;
        }
        
        @keyframes popIn {
            0% { transform: scale(0); }
            80% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .selected-dumpling-icon {
            font-size: 3rem;
        }
        
        .selected-dumpling-name {
            font-size: 1rem;
            margin-top: 5px;
            color: #666;
        }
        
        .funny-message {
            font-size: 1.3rem;
            color: #ff6b6b;
            margin: 15px 0;
            font-style: italic;
            animation: funnyPulse 2s infinite;
        }
        
        @keyframes funnyPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .letter-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 30;
            max-width: 500px;
            width: 90%;
            display: none;
            text-align: left;
            line-height: 1.6;
        }
        
        .letter-content {
            font-size: 1.2rem;
            color: #555;
        }
        
        .letter-signature {
            text-align: right;
            margin-top: 20px;
            font-style: italic;
            color: #ff6b6b;
        }
        
        .close-letter {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #ff6b6b;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 600px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .blind-dumpling {
                width: 80px;
                height: 80px;
            }
            
            .warm-message {
                font-size: 1.6rem;
            }
            
            .big-heart-container {
                width: 200px;
                height: 200px;
            }
            
            .small-heart {
                font-size: 1.8rem;
            }
            
            .letter-container {
                padding: 20px;
            }
            
            .letter-content {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â„ï¸ ç«‹å†¬æš–å¿ƒæ¸¸æˆ â„ï¸</h1>
            <p class="greeting">å—¨ï¼Œæ†¨è±†è±†ï¼å‡†å¤‡å¥½æ¥æ”¶æ¸©æš–å’Œæ¬¢ä¹äº†å—ï¼Ÿ</p>
            <p class="subtitle">ä¸“ä¸ºä½ è®¾è®¡çš„ç«‹å†¬æƒŠå–œï¼Œä¿è¯è®©ä½ ç¬‘å‡ºå£°ï¼</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <div class="current-option" id="current-option">
            <!-- è¿™é‡Œä¼šåŠ¨æ€æ˜¾ç¤ºå½“å‰é€‰é¡¹ -->
        </div>
        
        <div class="big-heart-container" id="big-heart-container">
            <!-- å°å¿ƒå¿ƒä¼šé€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <div class="final-message" id="final-message"></div>
        
        <div class="footer">
            <p>æ„¿è¿™ä¸ªå†¬å¤©ï¼Œæœ‰ä½ æ ¼å¤–æ¸©æš– <span class="heart">â¤ï¸</span></p>
            <p>â€”â€” æ¥è‡ªæƒ³é€—ä½ å¼€å¿ƒçš„æœ‹å‹</p>
        </div>
    </div>
    
    <div class="letter-container" id="letter-container">
        <div class="close-letter" id="close-letter">Ã—</div>
        <div class="letter-content" id="letter-content">
            <!-- ä¿¡ä»¶å†…å®¹ä¼šé€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let currentStep = 0;
        const totalSteps = 3;
        let selectedDumplings = [];
        let activeMessages = []; // è·Ÿè¸ªå½“å‰æ´»è·ƒçš„æ¶ˆæ¯ï¼Œé¿å…é‡å 
        
        // é¥ºå­æ•°æ® - å……æ»¡å¹½é»˜å’Œæ¸©æš–
        const dumplings = [
            { 
                icon: 'ğŸ¥Ÿ', 
                name: 'éŸ­èœé¸¡è›‹', 
                message: 'éŸ­èœé¸¡è›‹é¥ºå­ï¼åƒäº†å®ƒï¼Œä¿è¯ä½ æ¯”éŸ­èœè¿˜ç²¾ç¥ï¼',
                color: '#ff6b6b',
                fontSize: '2.2rem'
            },
            { 
                icon: 'ğŸ¥Ÿ', 
                name: 'ç¾Šè‚‰é¥ºå­', 
                message: 'ç¾Šè‚‰é¥ºå­ï¼æš–èº«åˆæš–å¿ƒï¼Œåƒäº†å®ƒå†¬å¤©ä¸æ€•å†·ï¼',
                color: '#ff9a3c',
                fontSize: '2rem'
            },
            { 
                icon: 'ğŸ¥Ÿ', 
                name: 'ç‰›è‚‰é¥ºå­', 
                message: 'ç‰›è‚‰é¥ºå­ï¼è¡¥å……èƒ½é‡ï¼Œåƒäº†å®ƒä½ èƒ½ä¸¾èµ·ä¸€å¤´ç‰›ï¼',
                color: '#06d6a0',
                fontSize: '1.8rem'
            },
            { 
                icon: 'ğŸ¥Ÿ', 
                name: 'ç´ é¥ºå­', 
                message: 'ç´ é¥ºå­ï¼å¥åº·ç¾å‘³ï¼Œåƒäº†å®ƒä½ ä¼šå˜å¾—æ›´å¸…ï¼',
                color: '#118ab2',
                fontSize: '2.1rem'
            },
            { 
                icon: 'ğŸ¥Ÿ', 
                name: 'å¹¸è¿é¥ºå­', 
                message: 'å¹¸è¿é¥ºå­ï¼æ­å–œä½ ï¼åƒäº†å®ƒä»Šå¹´ä¼šæœ‰å¥½è¿ï¼',
                color: '#7209b7',
                fontSize: '2.3rem'
            }
        ];
        
        // æ¸©æš–å¹½é»˜æ¶ˆæ¯
        const warmMessages = [
            "æ†¨è±†è±†ï¼Œä½ ç¬‘èµ·æ¥çœŸå¥½çœ‹ï¼",
            "è¿™ä¸ªå†¬å¤©æœ‰ä½ æ ¼å¤–æ¸©æš–ï¼",
            "æ„¿ä½ æ¯å¤©éƒ½æœ‰å¥½å¿ƒæƒ…ï¼",
            "ä½ æ˜¯æˆ‘å†¬å¤©é‡Œçš„å°å¤ªé˜³ï¼",
            "å¤šç¬‘ç¬‘ï¼Œç”Ÿæ´»æ›´ç¾å¥½ï¼",
            "ä½ æ¸©æš–äº†æ•´å€‹å†¬å¤©ï¼",
            "ä¿æŒå¾®ç¬‘ï¼Œä½ å°±æ˜¯æœ€é“çš„ä»”ï¼",
            "æ„¿ä½ è¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ï¼",
            "æ¯ä¸€å¤©éƒ½å› ä½ è€Œç¾å¥½ï¼",
            "ä½ å€¼å¾—æ‰€æœ‰çš„ç¾å¥½ï¼",
            "å†¬å¤©å†·ï¼Œä½†ä½ å¾ˆæš–ï¼",
            "ä½ çš„ç¬‘å®¹èƒ½èåŒ–å†°é›ªï¼",
            "æ„¿ä½ å†¬å¤©å¿«ä¹æ¯ä¸€å¤©ï¼",
            "ä½ æ˜¯æœ€ç‰¹åˆ«çš„ï¼",
            "ç«‹å†¬å¿«ä¹ï¼Œæ¸©æš–ç›¸ä¼´ï¼",
            "æ†¨è±†è±†æœ€å¯çˆ±ï¼",
            "ä½ çš„ç¬‘å£°æ˜¯æœ€å¥½å¬çš„éŸ³ä¹ï¼",
            "ä»Šå¤©ä¹Ÿè¦å¼€å¿ƒå“¦ï¼",
            "ä½ ç¬‘èµ·æ¥çš„æ ·å­çœŸè¿·äººï¼"
        ];
        
        // å¹½é»˜é—®é¢˜ - ä¸“é—¨è®¾è®¡æ¥é€—ç¬‘
        const quizQuestions = [
            {
                question: "ç«‹å†¬è¿™å¤©ï¼Œæ†¨è±†è±†çš„è€³æœµæ„Ÿè§‰æ€ä¹ˆæ ·ï¼Ÿ",
                options: [
                    "æœ‰ç‚¹å†·ï¼Œéœ€è¦é¥ºå­ä¿æŠ¤",
                    "çƒ­ä¹ä¹çš„ï¼Œå› ä¸ºå¿ƒé‡Œæƒ³ç€å¥½åƒçš„",
                    "æ²¡æ„Ÿè§‰ï¼Œå¯èƒ½è¢«å†»æ‰äº†ğŸ˜‚",
                    "åœ¨å¬æˆ‘çš„æš–å¿ƒç¥ç¦å‘¢"
                ],
                correct: 1,
                funnyResponse: "å“ˆå“ˆï¼Œçœ‹æ¥ä½ çš„è€³æœµå¾ˆå®‰å…¨ï¼"
            },
            {
                question: "å¦‚æœæ†¨è±†è±†æ˜¯å†¬å¤©çš„ä¸€ç§é£Ÿç‰©ï¼Œä¼šæ˜¯ä»€ä¹ˆï¼Ÿ",
                options: [
                    "çƒ­ä¹ä¹çš„é¥ºå­",
                    "ç”œç”œçš„ç³–è‘«èŠ¦", 
                    "æš–æš–çš„ç«é”…",
                    "å¯çˆ±çš„é›ªäººâ›„"
                ],
                correct: 3,
                funnyResponse: "é›ªäººæ†¨è±†è±†ï¼Œå¤ªå¯çˆ±äº†å§ï¼"
            },
            {
                question: "ç«‹å†¬æœ€é€‚åˆæ†¨è±†è±†åšä»€ä¹ˆï¼Ÿ",
                options: [
                    "çªåœ¨è¢«å­é‡Œç¡è§‰",
                    "åƒçƒ­æ°”è…¾è…¾çš„é¥ºå­",
                    "æƒ³å¿µè¿œæ–¹çš„æœ‹å‹",
                    "æ¥æ”¶æˆ‘çš„æ¸©æš–ç¥ç¦å¹¶å¼€å¿ƒå¤§ç¬‘"
                ],
                correct: 3,
                funnyResponse: "å¯¹å•¦ï¼å¼€å¿ƒå¤§ç¬‘æ˜¯æœ€å¥½çš„ä¿æš–æ–¹å¼ï¼"
            }
        ];
        
        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress() {
            const progress = document.getElementById('progress');
            const percentage = (currentStep / totalSteps) * 100;
            progress.style.width = percentage + '%';
        }
        
        // åˆ›å»ºç¥ç¦æ¶ˆæ¯ï¼ˆæ»¡å±é£˜åŠ¨ï¼Œé¿å…é‡å ï¼‰
        function createBlessingMessage(text, color, fontSize) {
            // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯
            activeMessages.forEach(msg => {
                if (msg.parentNode) {
                    msg.parentNode.removeChild(msg);
                }
            });
            activeMessages = [];
            
            // åˆ›å»ºå¤šä¸ªæ¶ˆæ¯å®ä¾‹ï¼Œè®©æ•ˆæœæ›´ä¸°å¯Œ
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const message = document.createElement('div');
                    message.className = 'blessing-message';
                    message.textContent = text;
                    
                    // è®¡ç®—ä½ç½®ï¼Œé¿å…é‡å 
                    const leftPositions = [10, 25, 40, 55, 70, 85]; // é¢„è®¾å‡ ä¸ªä½ç½®
                    const leftPosition = leftPositions[i % leftPositions.length] + (Math.random() * 5);
                    
                    message.style.left = leftPosition + '%';
                    message.style.top = '90vh';
                    message.style.animationDuration = (Math.random() * 3 + 5) + 's';
                    message.style.fontSize = fontSize;
                    message.style.color = color;
                    message.style.fontWeight = 'bold';
                    message.style.textShadow = '2px 2px 4px rgba(255, 255, 255, 0.9)';
                    
                    document.body.appendChild(message);
                    activeMessages.push(message);
                    
                    setTimeout(() => {
                        if (message.parentNode) {
                            message.parentNode.removeChild(message);
                            // ä»æ´»è·ƒæ¶ˆæ¯åˆ—è¡¨ä¸­ç§»é™¤
                            const index = activeMessages.indexOf(message);
                            if (index > -1) {
                                activeMessages.splice(index, 1);
                            }
                        }
                    }, 8000);
                }, i * 200);
            }
        }
        
        // è·å–éšæœºé¢œè‰²
        function getRandomColor() {
            const colors = ['#ff6b6b', '#ff9a3c', '#ffd166', '#06d6a0', '#118ab2', '#ef476f', '#7209b7', '#3a86ff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
        function createExplosion(x, y) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.innerHTML = 'ğŸ’¥';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            explosion.style.color = getRandomColor();
            
            document.body.appendChild(explosion);
            
            setTimeout(() => {
                if (explosion.parentNode) {
                    explosion.parentNode.removeChild(explosion);
                }
            }, 1500);
        }
        
        // åˆ›å»ºé›ªèŠ±ï¼ˆæ»¡å±é£˜åŠ¨ï¼‰
        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';
            snowflake.innerHTML = 'â„';
            snowflake.style.left = Math.random() * 100 + 'vw';
            snowflake.style.fontSize = (Math.random() * 20 + 15) + 'px';
            snowflake.style.opacity = Math.random() * 0.7 + 0.3;
            snowflake.style.animationDuration = (Math.random() * 5 + 5) + 's';
            snowflake.style.color = `rgba(179, 224, 255, ${Math.random() * 0.5 + 0.5})`;
            
            document.body.appendChild(snowflake);
            
            setTimeout(() => {
                if (snowflake.parentNode) {
                    snowflake.parentNode.removeChild(snowflake);
                }
            }, 10000);
        }
        
        // åˆ›å»ºæ¸©æš–æ¶ˆæ¯ï¼ˆæ»¡å±é£˜åŠ¨ï¼‰
        function createWarmMessage() {
            const message = document.createElement('div');
            message.className = 'warm-message';
            message.textContent = warmMessages[Math.floor(Math.random() * warmMessages.length)];
            message.style.left = Math.random() * 80 + 10 + '%';
            message.style.top = Math.random() * 80 + 10 + '%';
            message.style.animationDuration = (Math.random() * 8 + 8) + 's';
            message.style.color = getRandomColor();
            message.style.fontSize = (Math.random() * 0.5 + 1.8) + 'rem';
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                if (message.parentNode) {
                    message.parentNode.removeChild(message);
                }
            }, 12000);
        }
        
        // åˆ›å»ºå°å¿ƒå¿ƒç»„æˆçš„å¤§çˆ±å¿ƒ
        function createBigHeart() {
            const container = document.getElementById('big-heart-container');
            container.style.display = 'block';
            container.innerHTML = '';
            
            // å¿ƒå½¢åæ ‡ç®—æ³•
            const heartPoints = [];
            const numPoints = 80;
            
            for (let i = 0; i < numPoints; i++) {
                const t = i / numPoints * 2 * Math.PI;
                const x = 16 * Math.pow(Math.sin(t), 3);
                const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                
                heartPoints.push({
                    x: (x + 16) / 32 * 300, // ç¼©æ”¾å¹¶å±…ä¸­
                    y: (-y + 13) / 26 * 300 // ç¼©æ”¾å¹¶å±…ä¸­
                });
            }
            
            // åˆ›å»ºå°å¿ƒå¿ƒ
            heartPoints.forEach((point, index) => {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.className = 'small-heart';
                    heart.innerHTML = 'â¤';
                    heart.style.left = point.x + 'px';
                    heart.style.top = point.y + 'px';
                    heart.style.animationDelay = (index * 0.03) + 's';
                    heart.style.color = '#ff0000'; // æ‰€æœ‰å°å¿ƒå¿ƒéƒ½æ˜¯çº¢è‰²
                    
                    container.appendChild(heart);
                    
                    // å½“æœ€åä¸€ä¸ªå°å¿ƒå¿ƒåˆ›å»ºå®Œæˆåï¼Œæ˜¾ç¤ºä¿¡ä»¶
                    if (index === numPoints - 1) {
                        setTimeout(showLetter, 500);
                    }
                }, index * 30);
            });
        }
        
        // æ˜¾ç¤ºä¿¡ä»¶
        function showLetter() {
            const letterContainer = document.getElementById('letter-container');
            const letterContent = document.getElementById('letter-content');
            
            letterContent.innerHTML = `
                <p>äº²çˆ±çš„æ†¨è±†è±†ï¼š</p>
                <p style="margin-top:15px;">å¸Œæœ›è¿™ä¸ªå°æ¸¸æˆèƒ½ç»™ä½ å¸¦æ¥ä¸€äº›æ¸©æš–å’Œæ¬¢ä¹ï¼</p>
                <p style="margin-top:15px;">æ¯å½“çœ‹åˆ°ä½ ç¬‘ï¼Œæˆ‘çš„å¿ƒé‡Œå°±åƒè¿™æ»¡å±çš„çˆ±å¿ƒä¸€æ ·ï¼Œå……æ»¡äº†æ¸©æš–ã€‚</p>
                <p style="margin-top:15px;">ä½ æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„äººï¼Œæ€»æ˜¯èƒ½ç»™äººå¸¦æ¥å¿«ä¹å’Œæ­£èƒ½é‡ã€‚</p>
                <p style="margin-top:15px;">æ„¿è¿™ä¸ªå†¬å¤©ï¼Œæˆ‘çš„ç¥ç¦èƒ½åƒè¿™äº›è·³åŠ¨çš„å¿ƒä¸€æ ·ï¼Œ</p>
                <p>ä¸€ç›´é™ªä¼´ç€ä½ ï¼Œæ¸©æš–ä½ çš„æ¯ä¸€å¤©ã€‚</p>
                <p style="margin-top:15px;">è®°ä½ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œä½ éƒ½æ˜¯æœ€æ£’çš„ï¼</p>
                <p style="margin-top:15px;">æ„¿ä½ æ°¸è¿œä¿æŒé‚£ä»½çº¯çœŸçš„ç¬‘å®¹ï¼Œ</p>
                <p>æ„¿ä½ çš„ç”Ÿæ´»å……æ»¡é˜³å…‰å’Œå¿«ä¹ï¼</p>
                <div class="letter-signature">
                    <p>æ°¸è¿œæ”¯æŒä½ çš„æœ‹å‹</p>
                    <p>${new Date().getFullYear()}å¹´ç«‹å†¬</p>
                </div>
            `;
            
            letterContainer.style.display = 'block';
            
            // æ·»åŠ å…³é—­ä¿¡ä»¶çš„äº‹ä»¶
            document.getElementById('close-letter').addEventListener('click', function() {
                letterContainer.style.display = 'none';
            });
        }
        
        // æ˜¾ç¤ºç›²ç›’é¥ºå­
        function showBlindDumplings() {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = `
                <h2 style="color:#ff6b6b; margin-bottom:20px;">ğŸ¥Ÿ ç¬¬ä¸€æ­¥ï¼šæƒŠå–œé¥ºå­ç›²ç›’</h2>
                <p style="margin-bottom:20px; font-size:1.2rem;">ç«‹å†¬ä¸åƒé¥ºï¼Œå†»æ‰è€³æœµæ²¡äººç®¡ï¼</p>
                <p style="margin-bottom:20px; font-size:1.2rem;">é€‰3ä¸ªé¥ºå­ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆæƒŠå–œç­‰ç€ä½ ~</p>
                <div class="blind-dumplings">
                    ${dumplings.map((_, index) => `
                        <div class="blind-dumpling" data-index="${index}"></div>
                    `).join('')}
                </div>
                <div style="margin-top:20px; font-size:1.2rem; color:#666;">
                    å·²é€‰æ‹©: ${selectedDumplings.length}/3
                </div>
                <div class="funny-message">é€‰ä¸€ä¸ªå§ï¼Œä¿è¯è®©ä½ ç¬‘å‡ºå£°ï¼</div>
            `;
            
            // æ·»åŠ ç›²ç›’ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.blind-dumpling').forEach(dumpling => {
                dumpling.addEventListener('click', function() {
                    if (this.classList.contains('opened')) return;
                    
                    const index = parseInt(this.getAttribute('data-index'));
                    const selectedDumpling = dumplings[index];
                    
                    // æ ‡è®°ä¸ºå·²æ‰“å¼€
                    this.classList.add('opened');
                    this.innerHTML = selectedDumpling.icon;
                    
                    // æ·»åŠ åˆ°å·²é€‰æ‹©åˆ—è¡¨
                    selectedDumplings.push(selectedDumpling);
                    
                    // æ˜¾ç¤ºæ»¡å±ç¥ç¦æ¶ˆæ¯
                    createBlessingMessage(
                        selectedDumpling.message,
                        selectedDumpling.color,
                        selectedDumpling.fontSize
                    );
                    
                    // æ›´æ–°é€‰æ‹©è®¡æ•°
                    document.querySelector('.blind-dumplings + div').textContent = 
                        `å·²é€‰æ‹©: ${selectedDumplings.length}/3`;
                    
                    // å¦‚æœé€‰æ‹©äº†3ä¸ªï¼Œè¿›å…¥ä¸‹ä¸€æ­¥
                    if (selectedDumplings.length === 3) {
                        setTimeout(showSelectedDumplings, 2000);
                    }
                });
            });
        }
        
        // æ˜¾ç¤ºå·²é€‰æ‹©çš„é¥ºå­
        function showSelectedDumplings() {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = `
                <h2 style="color:#ff6b6b; margin-bottom:20px;">ğŸ‰ é¥ºå­é€‰æ‹©å®Œæˆï¼</h2>
                <p style="margin-bottom:20px; font-size:1.2rem;">ä½ é€‰æ‹©äº†è¿™äº›ç¾å‘³çš„é¥ºå­ï¼š</p>
                <div class="selected-dumplings">
                    ${selectedDumplings.map(dumpling => `
                        <div class="selected-dumpling">
                            <div class="selected-dumpling-icon">${dumpling.icon}</div>
                            <div class="selected-dumpling-name">${dumpling.name}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="funny-message">åƒé¥±äº†å—ï¼Ÿç°åœ¨æ¥ç‚¸æ‰æ‰€æœ‰çƒ¦æ¼å§ï¼</div>
                <button id="next-to-bomb" style="background:#ff9a3c; color:white; border:none; padding:12px 30px; border-radius:25px; font-size:1.2rem; cursor:pointer; margin-top:20px;">
                    ä¸‹ä¸€æ­¥ï¼šç‚¸æ‰çƒ¦æ¼ ğŸ’£
                </button>
            `;
            
            document.getElementById('next-to-bomb').addEventListener('click', function() {
                currentStep = 1;
                updateProgress();
                showBombQuiz();
            });
        }
        
        // æ˜¾ç¤ºç‚¸å¼¹å¹½é»˜ç­”é¢˜
        function showBombQuiz() {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = `
                <h2 style="color:#ff9a3c; margin-bottom:20px;">ğŸ’£ ç¬¬äºŒæ­¥ï¼šå¹½é»˜æ’é›·</h2>
                <p style="margin-bottom:20px; font-size:1.2rem;">å›ç­”å‡ ä¸ªæç¬‘é—®é¢˜ï¼Œç‚¸æ‰æ‰€æœ‰çƒ¦æ¼ï¼</p>
                <div class="quiz-container">
                    <div class="quiz-question" id="quiz-question">${quizQuestions[0].question}</div>
                    <div class="quiz-options" id="quiz-options">
                        ${quizQuestions[0].options.map((option, index) => `
                            <div class="quiz-option" data-index="${index}">${option}</div>
                        `).join('')}
                    </div>
                </div>
                <div style="margin-top:20px; font-size:1.2rem; color:#666;" id="quiz-progress">
                    é—®é¢˜ 1/3
                </div>
                <div class="funny-message" id="funny-response"></div>
            `;
            
            let currentQuestion = 0;
            let correctAnswers = 0;
            
            // æ·»åŠ é€‰é¡¹ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function() {
                    const selectedIndex = parseInt(this.getAttribute('data-index'));
                    const isCorrect = selectedIndex === quizQuestions[currentQuestion].correct;
                    
                    if (isCorrect) {
                        correctAnswers++;
                        this.style.background = '#c8f7c5';
                        document.getElementById('funny-response').textContent = quizQuestions[currentQuestion].funnyResponse;
                    } else {
                        this.style.background = '#ffcccc';
                        document.getElementById('funny-response').textContent = "å“ˆå“ˆï¼Œè¿™ä¸ªç­”æ¡ˆå¤ªæœ‰è¶£äº†ï¼";
                    }
                    
                    // ç¦ç”¨æ‰€æœ‰é€‰é¡¹
                    document.querySelectorAll('.quiz-option').forEach(opt => {
                        opt.style.pointerEvents = 'none';
                    });
                    
                    // è¿›å…¥ä¸‹ä¸€é¢˜æˆ–ç»“æŸ
                    setTimeout(() => {
                        currentQuestion++;
                        if (currentQuestion < quizQuestions.length) {
                            updateQuizQuestion(currentQuestion);
                        } else {
                            showBombExplosion(correctAnswers);
                        }
                    }, 2000);
                });
            });
            
            function updateQuizQuestion(questionIndex) {
                document.getElementById('quiz-question').textContent = 
                    quizQuestions[questionIndex].question;
                
                document.getElementById('quiz-options').innerHTML = 
                    quizQuestions[questionIndex].options.map((option, index) => `
                        <div class="quiz-option" data-index="${index}">${option}</div>
                    `).join('');
                
                document.getElementById('quiz-progress').textContent = 
                    `é—®é¢˜ ${questionIndex + 1}/3`;
                
                document.getElementById('funny-response').textContent = '';
                
                // é‡æ–°æ·»åŠ äº‹ä»¶ç›‘å¬
                document.querySelectorAll('.quiz-option').forEach(option => {
                    option.addEventListener('click', function() {
                        const selectedIndex = parseInt(this.getAttribute('data-index'));
                        const isCorrect = selectedIndex === quizQuestions[questionIndex].correct;
                        
                        if (isCorrect) {
                            correctAnswers++;
                            this.style.background = '#c8f7c5';
                            document.getElementById('funny-response').textContent = quizQuestions[questionIndex].funnyResponse;
                        } else {
                            this.style.background = '#ffcccc';
                            document.getElementById('funny-response').textContent = "å“ˆå“ˆï¼Œè¿™ä¸ªç­”æ¡ˆå¤ªæœ‰è¶£äº†ï¼";
                        }
                        
                        // ç¦ç”¨æ‰€æœ‰é€‰é¡¹
                        document.querySelectorAll('.quiz-option').forEach(opt => {
                            opt.style.pointerEvents = 'none';
                        });
                        
                        // è¿›å…¥ä¸‹ä¸€é¢˜æˆ–ç»“æŸ
                        setTimeout(() => {
                            currentQuestion++;
                            if (currentQuestion < quizQuestions.length) {
                                updateQuizQuestion(currentQuestion);
                            } else {
                                showBombExplosion(correctAnswers);
                            }
                        }, 2000);
                    });
                });
            }
        }
        
        // æ˜¾ç¤ºç‚¸å¼¹çˆ†ç‚¸æ•ˆæœ
        function showBombExplosion(correctAnswers) {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = `
                <h2 style="color:#ff9a3c; margin-bottom:20px;">ğŸ’¥ ç‚¸å¼¹å¼•çˆ†ä¸­...</h2>
                <p style="margin-bottom:20px; font-size:1.2rem;">ç­”å¯¹äº† ${correctAnswers}/3 é¢˜ï¼Œæ­£åœ¨æ¸…é™¤çƒ¦æ¼...</p>
                <div style="font-size:4rem; margin:20px 0;">ğŸ’£</div>
                <div class="funny-message">è½°éš†éš†ï¼æ‰€æœ‰çƒ¦æ¼éƒ½è¢«ç‚¸é£å•¦ï¼</div>
            `;
            
            // åˆ›å»ºå…¨å±çˆ†ç‚¸æ•ˆæœ
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight;
                    createExplosion(x, y);
                }, i * 150);
            }
            
            // è¿›å…¥ä¸‹ä¸€æ­¥
            setTimeout(() => {
                currentStep = 2;
                updateProgress();
                showSun();
            }, 3000);
        }
        
        // æ˜¾ç¤ºå¤ªé˜³é€‰é¡¹
        function showSun() {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = `
                <h2 style="color:#ffd166; margin-bottom:20px;">â˜€ï¸ ç¬¬ä¸‰æ­¥ï¼šæ”¶é›†æ¸©æš–</h2>
                <p style="margin-bottom:20px; font-size:1.2rem;">ç‚¹å‡»å¤ªé˜³æ”¶é›†æ¸©æš–èƒ½é‡ï¼Œæ¸©æš–æ•´ä¸ªå†¬å¤©ï¼</p>
                <div style="font-size:6rem; cursor:pointer; margin:20px 0; transition: all 0.3s ease;" id="sun-icon">â˜€ï¸</div>
                <div style="font-size:1.5rem; color:#ff9a3c; margin:15px 0;" id="energy-counter">æ¸©æš–èƒ½é‡: 0%</div>
                <div class="funny-message">å¤šç‚¹å‡ ä¸‹ï¼Œè®©æ¸©æš–å……æ»¡æ•´ä¸ªå±å¹•ï¼</div>
                <button id="complete-game" style="background:#ffd166; color:#333; border:none; padding:12px 30px; border-radius:25px; font-size:1.2rem; cursor:pointer; margin-top:10px; display:none;">
                    å®Œæˆæ”¶é›†
                </button>
            `;
            
            // æ”¹å˜èƒŒæ™¯ä¸ºæ›´æ¸©æš–çš„è‰²è°ƒ
            document.body.style.background = 'linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)';
            
            // æ·»åŠ å¤ªé˜³ç‚¹å‡»äº‹ä»¶
            let energy = 0;
            const sunIcon = document.getElementById('sun-icon');
            const energyCounter = document.getElementById('energy-counter');
            const completeButton = document.getElementById('complete-game');
            
            sunIcon.addEventListener('click', function() {
                if (energy < 100) {
                    energy += 10;
                    energyCounter.textContent = `æ¸©æš–èƒ½é‡: ${energy}%`;
                    
                    // å¤ªé˜³å›¾æ ‡åŠ¨ç”»
                    sunIcon.style.transform = `scale(${1 + energy/100})`;
                    sunIcon.style.color = energy >= 50 ? '#ff9f43' : '#ffd166';
                    
                    // æ¯æ¬¡ç‚¹å‡»åˆ›å»ºæ¸©æš–æ¶ˆæ¯
                    createWarmMessage();
                    
                    if (energy >= 100) {
                        completeButton.style.display = 'inline-block';
                        document.querySelector('.funny-message').textContent = "å¤ªæ£’äº†ï¼æ¸©æš–èƒ½é‡æ»¡æ ¼ï¼";
                    }
                }
            });
            
            completeButton.addEventListener('click', function() {
                // å®Œæˆæ‰€æœ‰æ­¥éª¤
                currentStep = 3;
                updateProgress();
                showFinalMessage();
            });
        }
        
        // æ˜¾ç¤ºæœ€ç»ˆæ¶ˆæ¯
        function showFinalMessage() {
            const currentOption = document.getElementById('current-option');
            currentOption.innerHTML = '';
            
            // åˆ›å»ºå°å¿ƒå¿ƒç»„æˆçš„å¤§çˆ±å¿ƒ
            createBigHeart();
            
            const finalMessage = document.getElementById('final-message');
            finalMessage.innerHTML = `
                <h2 style="color:#ff6b6b; margin-bottom:20px;">ğŸ‰ ç»™æœ€å¯çˆ±çš„æ†¨è±†è±†</h2>
                <p>äº²çˆ±çš„æ†¨è±†è±†ï¼Œ</p>
                <p>å¸Œæœ›è¿™ä¸ªå°æ¸¸æˆèƒ½è®©ä½ ç¬‘å‡ºå£°æ¥ï¼</p>
                <p>ä½ ç¬‘èµ·æ¥çš„æ ·å­ç‰¹åˆ«å¥½çœ‹ï¼Œåƒå†¬æ—¥é‡Œçš„æš–é˜³</p>
                <p>æ„¿è¿™ä¸ªå†¬å¤©ï¼Œæˆ‘çš„ç¥ç¦èƒ½åƒè¿™äº›è·³åŠ¨çš„å¿ƒä¸€æ ·</p>
                <p>æ¸©æš–ä½ çš„æ¯ä¸€å¤©ï¼Œç…§äº®ä½ çš„æ¯ä¸€åˆ»</p>
                <p style="margin-top:20px;">ğŸ˜Š è®°ä½ï¼šä½ çš„ç¬‘å®¹æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„ç¤¼ç‰©ï¼</p>
                <p>ğŸ¤£ å¤šç¬‘ç¬‘ï¼Œç”Ÿæ´»ä¼šæ›´ç¾å¥½ï¼</p>
                <p style="margin-top:20px; font-size:1.8rem; color:#ff6b6b;">æ„¿ä½ æ•´ä¸ªå†¬å¤©éƒ½æ¸©æš–ã€å¿«ä¹ã€å……æ»¡æ¬¢ç¬‘ï¼</p>
                <div class="funny-message">æ†¨è±†è±†æœ€æ£’ï¼æ†¨è±†è±†æœ€å¯çˆ±ï¼</div>
            `;
            finalMessage.style.display = 'block';
            
            // å¢åŠ é›ªèŠ±å¯†åº¦ - æ»¡å±é£˜åŠ¨
            setInterval(createSnowflake, 100);
            
            // åˆ›å»ºéšæœºæ¸©æš–æ¶ˆæ¯ - æ»¡å±é£˜åŠ¨
            setInterval(createWarmMessage, 1500);
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            showBlindDumplings();
            
            // åˆ›å»ºåˆå§‹é›ªèŠ±
            setInterval(createSnowflake, 500);
        }
        
        // å¯åŠ¨æ¸¸æˆ
        initGame();
    </script>
</body>
</html>